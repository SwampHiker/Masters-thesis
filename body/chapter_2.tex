\newpage
\begin{center}
	\textbf{\large 2. МОДЕЛЬ ВЗАИМОДЕЙСТВИЯ БЕЛКОВ}
\end{center}
\refstepcounter{chapter}
\addcontentsline{toc}{chapter}{2. МОДЕЛЬ ВЗАИМОДЕЙСТВИЯ БЕЛКОВ}
Цель данной главы -- предложить класс физических моделей, которые потенциально могут описывать взаимодействие белковых молекул.
В предыдущих работах [!ref] предлагалось напрямую предсказывать комформацию белковых комплексов с помощью полносвёрточных нейронных сетей,
и матрицы косинусов использовались в качестве инвариантной кодировки таких конформаций. В данной работе предлагается подход, близкий к классическому методу потенциалов.

\section{Лагранжев формализм классической релятивистской теории поля}
Опираясь на [!ref] кратко изложим суть данного формализма. Пусть имеется четырёхмерное пространство-время (трёхмерное пространство + время).
Пусть в данном пространстве можно задать $n$ обобщённых переменных:
\begin{equation}
	u_1(x_1, x_2, x_3, x_4), ..., u_n(x_1, ..., x_4);
	\label{generalized_variables}
\end{equation}
где $x_4 = ict$. У этих переменных можно вычислить
частные производные по каждой из координат: $\frac{\partial{u_1}}{\partial{x_1}}, ..., \frac{\partial{u_n}}{\partial{x_4}}$. Также могут использоваться производные
более высоких порядков, но в большинстве теорий обходятся лишь первым порядком.

Зададим действительнозначную $L(u_1, ..., u_n, \frac{\partial{u_1}}{\partial{x_1}}, ..., \frac{\partial{u_n}}{\partial{x_4}})$ -- \textit{функцию Лагранжа} или \textit{лагранжиан}.
В релятивистской теории на лагранжиан накладывается требование \textit{Лоренц-инвариантности}.

\textit{Преобразования Лоренца} -- это такие преобразования, которые сохраняют скалярные произведения в пространстве времени, т.е.:
\begin{equation}
	<f(x), f(y)> = <x, y>,
	\label{Lorenz_group}
\end{equation}
при условии, что для пространства-веремени скалярное произведение записывается как:
\begin{equation}
	<x, y> = x_1y_1 + x_2y_2 + x_3y_3 + x_4y_4 = x_1y_1 + x_2y_2 + x_3y_3 - c^2t_xt_y.
	\label{Minkowski_product}
\end{equation}

Из курса линейной алгебры известно, что преобразование $f$, обладающее свойством \ref{Lorenz_group}, является изометрическим, и ему буедт соответствовать
четырёхмерная комплексная ортогональная матрица $A$ ($A^\mathrm{T}=A^{-1}$) (не стоит путать с унитарной матрицей ($\overline{A}^\mathrm{T}=A^{-1}$)).

Если обобщённые координаты \ref{generalized_variables} задают скаляры, то их производные будут векторами, если переменные задают векторы, то их производные будут матрицами.
При Лоренц-преобразовании, заданном матрицей $A$ ($x \rightarrow Ax$), векторы и матрицы, входящие в лагранжиан, также будут изменяться
($v \rightarrow Av$; $M \rightarrow AMA^\mathrm{T}$). Требование Лоренц-инвариантности заключается в том, что преобразования Лоренца не должны изменять значение функции Лагранжа.

Если имеется Лоренц-инвариантный лагранжиан, то можно задать \textit{функцию действия}:
\begin{equation}
	S = \int_{spacetime}L(u_1, ..., u_n, \frac{\partial{u_1}}{\partial{x_1}}, ..., \frac{\partial{u_n}}{\partial{x_4}}) \, dx_1 \, dx_2 \, dx_3 \, dx_4.
	\label{action_function}
\end{equation}

Поведение системы, таким образом, описывается с помощью \textit{принципа стационарного действия}:
\begin{equation}
	S \rightarrow \min.
	\label{lagrangian_principle}
\end{equation}
Задачи типа \ref{lagrangian_principle} обычно решают с помощью вариационного исчисления. Из принципов вариационного исчисления и инвариантности относительно преобразований
\ref{Lorenz_group} следует теорема Нётер и автоматически выводимые из неё фундаментальные физические законы сохранения. Поэтому при моделировании белковых взаимодействий,
довольно привлекательно выглядит свойство Лоренц-инвариантности, так как с помощью него можно попытаться избежать явного учёта законов сохранения.

\section{Общая модель взаимодействия белков с применением релятивистских матриц косинусов}
Белковые молекулы являются полимерными молекулами. Они являются линейными последовательностями аминокислотных остатков, соединённых пептидными связями. В каждом из остатков
находится атом C\textalpha. В общем случае, знания пространственного расположения этих атомов и знания соответствующих аминокислтных остатков достаточно, чтобы полностью задать структуру белковой молекулы.
Кроме того, расстояние между соседними C\textalpha-атомами является практически константным, и равно 3,8\AA. Эти факты способствуют тому, чтобы можно было использовать матрицы косинусов для задания белковых структур.
Введение релятивистской матрицы косинусов \ref{C_rel_definition} позволяет задать как структуру молекулы, так и некоторую точку пространства-времени относительно неё. При этом, важным достоинством релятивистской матрицы является её Лоренц-инвариантность. Действительно, легко видеть, что от скалярных произведений, составляющих $C_{rel}$ в \ref{C_rel_definition}, в \ref{Lorenz_group} требуется инвариантность. Таким образом, если обычная матрица косинусов была инвариантна относительно изометрических преобразований в обычном евклидовом пространстве, то релятивистская матрица инвариантна относительно преобразований Лоренца в пространстве-времени. Следовательно, можно задавать обобщенные функции поля как функционалы над $C_{rel}$. Также необходимо отметить, что, так как $C_{rel}$ содержит в себе закодированным, в том числе, расстояние между точкой наблюдения и наблюдаемыми атомами, но делает это в неявной форме и без обращения этих расстояний, то при использовании описываемого подхода можно обойти проблему бесконечного роста функций поля при сближении атома и точки наблюдения.

Теперь дадим формальное описание данной модели в наиболее общем случае. Для начала, запишем:
\begin{equation}
	C_{rel} = C(X, \vec{x}_{ref}) \in \mathbb{R}_{m,m},
\end{equation}
где $X$ - последовательность точек -- C\textalpha-атомов описываемой молекулы в пространстве-времени, $\vec{x}_{ref}$ -- точка наблюдения, которой могут соответствовать координаты
$x_{ref} = [x_{ref}^1, x_{ref}^2, x_{ref}^3, x_{ref}^4] = [x_{ref}^1, x_{ref}^2, x_{ref}^3, ict_{ref}]$.
Тогда \ref{generalized_variables} можно выразить с помощью некоторого набора функционалов, принимающих на вход матрицу и данные об аминокислотной последовательности:
\begin{equation}
	u_l = F_l(C_{rel}, A) : \mathbb{R}_{m,m} \oplus \mathbb{A} \rightarrow \mathbb{C}; l=\overline{1..n}.
	\label{generalized_variables1}
\end{equation}

Тогда функция действия \ref{action_function} для одной белковой молекулы запишется как:
\begin{equation}
	S = \int_{spacetime}L(F_1(C(X, \begin{bmatrix} x_1 \\ x_2 \\ x_3 \\ x_4 \end{bmatrix}), A), ...,\frac{\partial{F_1(C(X, x), A)}}{\partial{x_1}}, ...) \, dx_1 \, dx_2 \, dx_3 \, dx_4.
	\label{action_function1}
\end{equation}

Если \ref{action_function} параметризовывалась обощенными функциями поля (т.е. решением \label{lagrangian_principle} были значения поля во всех точках пространства времени), то
\ref{action_function1} параметризуется ломаной $X(t)$ в пространстве-времени. Поэтому принцип стационарного действия \ref{lagrangian_principle} запишется как:
\begin{equation}
	X^{sol} = \argmin_{X}S.
	\label{lagrangian_principle1}
\end{equation}

Выражения \ref{action_function1} и \ref{lagrangian_principle1} описывают одну белковую молекулу, и, таким образом, задают модель её свёртки (без явного учёта растворителя и внешних сил).
Данные выражения легко обобщить на случай взаимодействия двух молекул, и далее на любое число белковых молекул, и даже на лиганды (для них, впрочем, в общем случае подход с релятивистской
матрицей косинусов и функционалом не подходит из-за нелинейности). Запишем модель для двух белковых молекул, описывамых парами $(X_1, A_1)$ и $(X_2, A_2)$:
\begin{equation}
	u_l(x) = F_l(C(X_1, x), A_1) + F_l(C(X_2, x), A_2), l=\overline{1..n};
	\label{generalized_variables2}
\end{equation}
\begin{align}
	S = \int_{spacetime}L(&F_1(C(X_1, x), A_1) + F_1(C(X_2, x), A_2), ...,\notag \\
						    &\frac{\partial{F_1(C(X_1, x), A_1)}}{\partial{x_1}} + \frac{\partial{F_1(C(X_2, x), A_2)}}{\partial{x_1}}, ... \notag \\
						    &) \, dx_1 \, dx_2 \, dx_3 \, dx_4;
	\label{action_function2}
\end{align}
\begin{equation}
	(X^{sol}_1, X^{sol}_2) = \argmin_{X_1, X_2}S.
	\label{lagrangian_principle2}
\end{equation}

Таким образом получили наиболее общую модель описания взаимодействия. При отстутствии явных выражений для \ref{generalized_variables1} аналитическое исследование такой системы невозможно. Впрочем, даже при наличии таких выражений, оно скорее всего было бы крайне сложным. Численный анализ и поиск таких функционалов также крайне затруднён, особенно с учётом того, что модель описывает полную динамику белковой молекулы, а экспериментальных данных такого рода де-факто не существует. Экспериментально получены лишь статические модели белковых молекул, а динамику получают с помощью рассчётов, полученных из теоретических соображений.

\section{Упрощённая модель взаимодействия белков}
Упростим предложенную модель по следующим пунктам:
\begin{enumerate}
\item Так как скорости движения белковых молекул крайне малы, по сравнению со скоростью света, то вместо полной релятивистской матрицы косинусов \ref{C_rel_definition} следует
использовать \ref{C_rel_definition_practical}.
\item Так как функционалы \ref{generalized_variables1} на практике будут аппроксимациями, полученными с помощью машинного обучения, то использование частных
производных от таких аппроксимаций может давать весьма сомнительные результаты (что связано с тем, что оператор дифференцирования не является непрерывным в теории функционального анализа), поэтому
опустим все явные вхождения частных производных в лагранжиан.
\item Так как вместе с этим опустится производная по времени, то, тем самым, будет получена статическая модель для белковых взаимодействий.
\item Для снижения количества степеней свободы, можно положить, как часто делают, что большие белковые молекулы жёсткие. Тогда они будут моделироваться как
абсолютно твёрдые тела, и будут параметризованы своим поворотом и сдвигом в пространстве.
\end{enumerate}
Применяя данные упрощения, мы более не будем иметь дело с релятивистской моделью, однако упрощённая модель всё еще может считаться некоторым
классическим механическим приближением такой общей модели.

Рассмотрим последствия предложенных упрощений:
\begin{align}
	X_1(t) = \const, \\
	X_2(t) = \const, \\
	X_1 = X_1(\alpha), \\
	X_2 = X_2(\alpha),
\end{align}
где $\alpha$ - обобщённый параметр, кодирующий взаимную конформацию молекул $X_1$ и $X_2$. Выражение \ref{generalized_variables1} остаётся без изменений.
Функция действия для одной молекулы примет вид:
\begin{align}
	S_1(\alpha) &= \int_{\mathbb{R}^3}L(F_1(C(X_1(\alpha), x), A_1), ...,F_n(C(X_1(\alpha), x), A_1)) \, dx_1 \, dx_2 \, dx_3 = \notag \\
				 &= \const,
	\label{action_function_single}
\end{align}
что обусловлено тем, что повороты и сдвиги не приведут к изменению суммарной функции действия. Функция действия двух молекул будет иметь вид:
\begin{align}
	S(\alpha) = \int_{\mathbb{R}^3}L(&F_1(C(X_1(\alpha), x), A_1)+F_1(C(X_2(\alpha), x), A_2), ..., \notag \\
                                                     &F_n(C(X_1(\alpha), x), A_1) + F_n(C(X_2(\alpha), x), A_2)) \, dx_1 \, dx_2 \, dx_3.
	\label{action_function_two}
\end{align}
Принцип стационарного действия примет вид:
\begin{equation}
	\alpha_{sol} = \argmin_{\alpha}S.
	\label{lagrangian_principle_practical}
\end{equation}

Из-за константности \ref{action_function_single} можно ввести \textit{частичный лагранжиан}:
\begin{align}
	L_{partial}(\alpha; x) &= L(F_1(C(X_1(\alpha), x), A_1)+F_1(C(X_2(\alpha), x), A_2), ...) - \notag \\
						   &- L(F_1(C(X_1(\alpha), x), A_1), ...) - L(F_1(C(X_2(\alpha), x), A_2), ...) = \notag \\
						   &= L(\alpha; x) - L_1(\alpha; x) - L_2(\alpha; x),
	\label{partial_lagrangian}
\end{align}
вычислив интеграл по которому, получим:
\begin{equation}
	\int_{\mathbb{R}^3}L_{partial}(\alpha; x) \, dx_1 \, dx_2 \, dx_3 = S(\alpha) - \const - \const,
\end{equation}
а следовательно:
\begin{equation}
	\alpha_{sol} = \argmin_{\alpha}\int_{\mathbb{R}^3}L_{partial}(\alpha; x) \, dx_1 \, dx_2 \, dx_3 = \argmin_{\alpha}S.
	\label{lagrangian_principle_practical_partial}
\end{equation}

Использование \ref{partial_lagrangian} будет полезно с численной точки зрения, а также весьма удобно при определённой степени линейности лагранжианов.

\section{Возможные варианты выбора функции Лагранжа}
\subsection{Скалярное поле}
В случае отсутствия частных производных, лагранжиан для скалярного поля $u$ примет вид:
\begin{equation}
	L(u) = au^2,
	\label{L_scalar}
\end{equation}
где $a$ - некоторая константа. Система ведёт себя принципиально разно при положительных и отрицательных $a$.

Модель с таким лагранжианом крайне бедна. Несколько обогатить её можно если использовать не одно, а $n$ скалярных полей:
$U = [u_1, ..., u_n]^\mathrm{T}$. Тогда имея некоторую постоянную $A \in \mathbb{R}_{n,n}$ запишем:
\begin{equation}
	L(U) = U^\mathrm{T}AU.
	\label{L_multiscalar}
\end{equation}
Таким образом получаем мультискалярное поле, функция Лагранжа которого -- квадратичная форма.
Мультискалярное поле отличается от векторного поля тем, что оно не меняется при преобразованиях Лоренца (ну или хотя бы при поворотах пространства).
Не нарушая общности, для квадратичных форм, можно считать $A$ -- симметричной ($A = A^\mathrm{T}$). Частичный лагранжиан будет иметь вид:
\begin{align}
	L_{partial}(U_1, U_2) &= L(U_1 + U_2) - L(U_1) - L(U_2) = \notag \\
						   &= (U_1+U_2)^\mathrm{T}A(U_1+U_2) - U_1^\mathrm{T}AU_1 - U_2^\mathrm{T}AU_2 = \notag \\
						   &=U_1^\mathrm{T}AU_2 + U_2^\mathrm{T}AU_1 = U_1^\mathrm{T}(A+A^\mathrm{T})U_2 = \notag \\
						   &=2U_1^\mathrm{T}AU_2.
	\label{L_partial_multiscalar}
\end{align}
Таким образом, частичный лагранжиан -- билинейная форма.

Матрица $A$ выражает взаимодействие различных полей друг с другом. Так как она симметричная, её можно диагонализировать (получим диагональную $A'$), и тем самым получить
набор новых полей $U' = [u'_1, ..., u'_n]^\mathrm{T}$, которые не будут взаимодействовать друг с другом, а только с самими собой. Вообще говоря,
абсолютные значения элементов $A'$ не важны, важны только их знаки, поэтому можно задать \ref{L_multiscalar} как:
\begin{equation}
	L(U') = {U'}^\mathrm{T}A'U'={\begin{bmatrix} U^+ \\ U^- \end{bmatrix}}^\mathrm{T}\begin{bmatrix} E & 0 \\ 0 & -E \end{bmatrix}\begin{bmatrix} U^+ \\ U^- \end{bmatrix},
	\label{L_multiscalar_diag}
\end{equation}
где лишние скалярные поля можно полагать нулевыми.

Функционал, способный задать скалярное поле, можно задать различными способами. Эксперименты показали, что наиболее практичный путь - следующий:
имея скаляр $u$, будем задавать вектор $v = [0, 0, 0, -iu]^\mathrm{T}$. Тогда \ref{generalized_variables1}, с помощью некоторого преобразования $G$, можно представить так:
\begin{equation}
	G : \mathbb{R}_{m,m} \oplus \mathbb{A} \rightarrow \mathbb{R}_{m,m},
\end{equation}
\begin{equation}
	C_{rel, v} = G(C_{rel}, A),
\end{equation}
\begin{equation}
	u = F(C_{rel}, A) = \begin{bmatrix} 0 & 0 & 0 &i \end{bmatrix}T_{X}G(C_{rel}, A)\begin{bmatrix} \frac{1}{m} \\ ... \\ \frac{1}{m} \end{bmatrix}.
	\label{scalar_F}
\end{equation}
Такое задание скалярное поля - это частный случай задания векторного поля, где собственно векторная часть нулевая.
При таком задании, повороты в пространстве не изменят поля, но преобразования Лоренца в общем случае могут вернуть векторную компоненту, что, впрочем, не
является большой проблемой, так как \ref{L_scalar} можно переписать как:
\begin{equation}
	L(v) = au^2 = a<v,v>.
	\label{L_scalar_vec}
\end{equation}

\subsection{Векторное поле}
Векторное поле задаётся вектором $v = [u_1, u_2, u_3, u_4]^\mathrm{T} = [v_1, v_2, v_3, iv_4]^\mathrm{T}$. Такое векторное поле не является чисто векторным, но также содержит в себе и скалярное.
Его лагранжиан можно задать с помощью \ref{L_scalar_vec} (легко видеть, что лагранжиан Лоренц-инвариантен) и аналогично \ref{L_multiscalar} обобщить на мультивекторный случай.
Формулу \ref{scalar_F} можно переписать так:
\begin{equation}
	v = F(C_{rel}, A) = T_{X}G(C_{rel}, A)\begin{bmatrix} \frac{1}{m} \\ ... \\ \frac{1}{m} \end{bmatrix}.
	\label{scalar_F}
\end{equation}

В общем и целом векторные поля, заданные таким образом, мало отличаются от скалярных. Главным отличием здесь является чувствительность к поворотам в пространстве,
что добавляет некоторых трудностей при обучении задаче предсказания взаимодействия белков. При этом модель оказывается не на много лучше мультискалярной модели.

% \subsection{Поле, заданное матрицей}
% Я думаю, для отчёта пока хватит и этого. 





